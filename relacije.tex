\chapter{Relacije}\label{POGLAVJE: Relacije}

	\section{Splošno o relacijah}
	
		V matematiki pogosto želimo izraziti, da so določeni objekti v nekem odnosu, npr.~eno število je večje od drugega; temu s tujko rečemo \df{relacija}. Kako to formalno izraziti? Ideja je, da relacijo podamo z množico vseh skupin elementov, ki so v relaciji. Na primer, relacijo $\leq$ na naravnih številih podamo kot podmnožico
		\[\set[1]{(a, b) \in \NN \times \NN}{\xsome{n}[\NN]{a + n = b}}.\]
		Torej, število $a$ je v relaciji $\leq$ s številom $b$ takrat, ko par $(a, b)$ pripada tej množici.
		
		Splošne relacije so lahko med poljubno mnogo elementi iz poljubnih (ne nujno istih) množic. Na primer, relacija komplanarnosti štirih točk v prostoru je podmnožica produkta $\RR^3 \times \RR^3 \times \RR^3 \times \RR^3$, relacija pripadnosti $\in$ med elementi neke množice $X$ in podmnožicami množice $X$ pa je podmnožica produkta $X \times \pst(X)$.
		
		Splošna definicija relacije je potemtakem naslednja.
		\begin{definicija}
			\df{Relacija} na družini množic $\mathscr{D}$ je podmnožica produkta $\prod_{X \in \mathscr{D}} X$.
		\end{definicija}
		
		V praksi se povečini uporabljajo relacije med dvema elementoma.
		\begin{definicija}
			\df{Dvojiška} (ali s tujko \df{binarna}) \df{relacija} med elementi množic $X$ in $Y$ je podmnožica produkta $X \times Y$. V tem primeru imenujemo množico $X$ \df{domena}, množico $Y$ pa \df{kodomena} relacije $R$.
		\end{definicija}
		
		Skoraj vse relacije, ki nas zanimajo v tej knjigi, so dvojiške. Zato se dogovorimo, da z izrazom \qt{relacija} vselej mislimo dvojiško relacijo, razen če je izrecno rečeno drugače.
		
		Če je $R \subseteq X \times Y$ relacija, potemtakem lahko zapišemo, da sta $x \in X$ in $y \in Y$ v relaciji $R$ takole: $(x, y) \in R$. Ampak to vodi do čudnih zapisov v primeru običajnih relacij, npr.~$(2, 3) \in <$. To je bolje zapisati $2 < 3$ in posledično se dogovorimo, da v primeru dvojiške relacije raje uporabljamo zapis $x \mathrel{R} y$.
		
		Povečini se še dodatno omejimo na relacije z isto domeno in kodomeno.
		\begin{definicija}
			\df{Dvojiška} (ali \df{binarna}) \df{relacija} na množici $X$ je podmnožica produkta $X \times X$.
		\end{definicija}
		
		Takšne relacije lahko lepo ponazorimo z usmerjenimi grafi. Graf relacije $R \subseteq X \times X$ je definiran takole: vozlišča grafa so elementi množice $X$ in za vsaka dva elementa $a, b \in X$, za katera velja $a \mathrel{R} b$, narišemo puščico od $a$ do $b$.
		
		\GraphInit[vstyle = Normal]
		\tikzset
		{
			EdgeStyle/.append style = {->, bend left}
		}
		
		\begin{zgled}\label{ZGLED: graf relacije}
			Naj bo $X = \set{A, B, C, D, E, F}$ in naj bo
			\[R \dfeq \set{...}\]
			relacija na $X$. Njen graf izgleda takole.
			
			\note{graf relacije $R$}
			%\begin{center}
				%\begin{tikzpicture}
					%\SetGraphUnit{3}
					%\Vertex[Math=true, x=0, y=0]{A}
					%\Vertex[Math=true, x=3, y=2]{B}
					%\Vertex[Math=true, x=2, y=-3]{C}
					%\Vertex[Math=true, x=6, y=1]{D}
					%\Vertex[Math=true, x=8, y=-1]{E}
					%\Vertex[Math=true, x=10, y=2]{F}
					%
					%\Edge(A)(B)
					%\Loop[dist = 5em, dir = EA](B)
				%\end{tikzpicture}
			%\end{center}
			%\note{izgled grafa je še treba popraviti}
		\end{zgled}
	
	
	\section{Operacije z relacijami}\label{RAZDELEK: Operacije z relacijami}
	
		Običajno je, da iz že danih matematičnih objektov lahko skonstruiramo nove preko določenih operacij. Z relacijami ni nič drugače; v tem razdelku si bomo ogledali običajne operacije na relacijah.
		
		Ker so relacije podmnožice, imamo za začetek vse operacije na podmnožicah. Torej, za poljubno družino $(R_i)_{i \in I}$ podmnožic produkta $X \times Y$ sta tudi unija $\bigcup_{i \in I} R_i$ in presek $\bigcap_{i \in I} R_i$ relaciji. Če je $R \subseteq X \times Y$ relacija, je njena komplementarna relacija $\complement{R} = X \times Y \setminus R \ \subseteq \ X \times Y$.
		
		Posebej imamo \df{prazno relacijo} $\emptyset \subseteq X \times Y$ (nobena dva elementa nista v relaciji) in \df{polno relacijo} $X \times Y\subseteq X \times Y$ (vsaka dva elementa sta v relaciji), ki sta si medsebojno komplementarni.
		
		Poleg operacij, ki jih relacije podedujejo od podmnožic, imamo še operacije, ki upoštevajo produktno strukturo.
		
		Če so $X$, $Y$, $Z$ množice in $R \subseteq X \times Y$, $S \subseteq Y \times Z$ relaciji, tedaj je \df{sklop} (\df{kompozitum}) \df{relacij} definiran kot
		\[S \circ R \dfeq \set[1]{(x, z) \in X \times Z}{\some{y}[Y]{x \mathrel{R} y \land y \mathrel{S} z}}\]
		(po vzoru funkcij tudi kompozicijo relacij pišemo v obratnem vrstnem redu; glej razdelek~\ref{RAZDELEK: Funkcije kot funkcijske relacije}). Opazimo: domena $S \circ R$ je domena $R$, kodomena $S \circ R$ je kodomena $S$. Sklapljanje je asociativna operacija, torej pri sklopu večih relacij oklepaji niso pomembni.
		
		Večkraten sklop relacije $R \subseteq X \times X$ same s sabo označimo
		\[R^n \dfeq \underbrace{R \circ R \circ \ldots \circ R}_{\text{$n$ $R$-jev}}\]
		za $n \in \NN_{\geq 2}$. Seveda je smiselno definirati, da je $R^1$ enak $R$ in da je $R^0$ relacija enakosti na množici $X$, saj je to enota za sklapljanje relacij na $X$, tj.~$=_X \circ R = R = R \circ =_X$ (premisli, da je to res!).
		
		\begin{zgled}
			Naj bo $R \subseteq X \times X$ relacija. Tedaj iz grafa relacije zlahka razberemo, kaj je $R^n$: elementa $a, b \in X$ sta v relaciji $R^n$ natanko tedaj, ko imamo pot dolžine $n$ od $a$ do $b$ (to deluje tudi za $n = 1$ in $n = 0$). Naj primer, če je $R$ relacija iz zgleda~\ref{ZGLED: graf relacije}, tedaj graf relacije $R^3$ izgleda takole.
			
			\note{graf $R^3$}
		\end{zgled}
		
		Za poljubno relacijo $R \subseteq X \times Y$ definiramo \df{obratno} (\df{inverzno}) \df{relacijo} kot
		\[R^{-1} \dfeq \set{(y, x) \in Y \times X}{x \mathrel{R} y}\]
		(torej ima obratna relacija glede na izvorno zamenjano domeno in kodomeno). Posledično lahko za poljubno relacijo $R \subseteq X \times X$ definiramo njeno potenco s poljubno celo stopnjo: $R^{-n} \dfeq (R^{-1})^n = (R^n)^{-1}$.
		
		\begin{zgled}
			Graf relacije, ki je inverzna relaciji $R \subseteq X \times X$, dobimo tako, da v grafu relacije $R$ obrnemo puščice. Na primer, če je $R$ relacija iz zgleda~\ref{ZGLED: graf relacije}, tedaj graf relacije $R^{-1}$ izgleda takole.
			
			\note{graf $R^{-1}$}
		\end{zgled}
		
		\begin{zgled}
			Naj bo $L$ množica ljudi. Vpeljimo oznake za naslednje relacije na $L$:
			\begin{itemize}
				\item
					$\texttt{St}$ je relacija \qt{je starš od},
				\item
					$\texttt{Oč}$ je relacija \qt{je oče od},
				\item
					$\texttt{Ma}$ je relacija \qt{je mati od},
				\item
					$\texttt{Si}$ je relacija \qt{je sin od},
				\item
					$\texttt{Hč}$ je relacija \qt{je hči od},
				\item
					$\texttt{Br}$ je relacija \qt{je brat od},
				\item
					$\texttt{Se}$ je relacija \qt{je sestra od}
			\end{itemize}
			
			Na primer: Marko $\texttt{Br}$ Metka pomeni \qt{Marko je brat od Metke.} (oz.~v lepši slovenščini \qt{Marko je Metkin brat.}).
			
			Velja med drugim:
			
			\begin{tabular}{l}
				$\texttt{Oč} \cup \texttt{Ma} = \texttt{St}$, \\
				$\texttt{St} \circ \texttt{St} = \texttt{St}^2 = \text{\qt{je stari starš od}}$, \\
				$\texttt{St} \circ \texttt{Br} = \text{\qt{je stric od}}$, \\
				$\texttt{Br} \cup \texttt{Se} = \text{\qt{je sorojenec od}}$, \\
				$\texttt{St}^{-1} = \text{\qt{je otrok od}}$, \\
				$\bigcup_{n \in \NN_{\geq 1}} \texttt{St}^n = \text{\qt{je prednik od}}$, \\
				$\bigcup_{n \in \NN_{\geq 1}} \texttt{St}^{-n} = \text{\qt{je potomec od}}$, \\
				$\texttt{St} \circ (\texttt{Br} \cup \texttt{Se}) \circ \texttt{Hč} = \text{\qt{je sestrična od}}$.
			\end{tabular}
			
			Sklapljanje relacij ni komutativno; na primer $\texttt{Ma} \circ \texttt{Oč}$ je stari oče po materini strani, $\texttt{Oč} \circ \texttt{Ma}$ pa stara mama po očetovi strani.
			
			\note{V tem zgledu sicer predpostavljamo, da je vsaka oseba bodisi moškega bodisi ženskega spola, kar ni čisto res. Ima kdo kakšno idejo, kako se temu izogniti (in še vedno imeti lahko razumljiv zgled)?}
		\end{zgled}
	
	
	\section{Lastnosti relacij}
	
		Vemo, da so na primer racionalna števila uporabnejša od celih, saj lahko v okviru njih dodatno delimo --- z drugimi besedami, racionalna števila imajo več uporabne \emph{strukture} oz.~več uporabnih \emph{lastnosti}. Podobno za relacije obstajajo lastnosti, ki so se skozi prakso izkazale za zelo uporabne. Nekatere izmed njih si bomo ogledali v tem razdelku.
		
		Vse sledeče lastnosti se nanašajo na dvojiško relacijo z isto domeno in kodomeno.
		
		\begin{definicija}
			Naj bo $R \subseteq X \times X$ relacija.
			\begin{itemize}
				\item
					Relacija $R$ je \df{povratna} (ali \df{refleksivna}), kadar velja
					\[\xall{x}[X]{x \mathrel{R} x},\]
					tj.~vsak element je v relaciji s samim sabo.
				\item
					Relacija $R$ je \df{nepovratna} (ali \df{irefleksivna}), kadar velja
					\[\xall{x}[X]{\lnot(x \mathrel{R} x)},\]
					tj.~noben element ni v relaciji s samim sabo.
				\item
					Relacija $R$ je \df{somerna} (ali \df{simetrična}), kadar velja
					\[\all{x, y}[X]{x \mathrel{R} y \implies y \mathrel{R} x},\]
					tj.~če je en element v relaciji z drugim, je tudi drugi s prvim.
				\item
					Relacija $R$ je \df{protisomerna} (ali \df{antisimetrična}), kadar velja
					\[\all{x, y}[X]{x \mathrel{R} y \land y \mathrel{R} x \implies x = y},\]
					tj.~dva elementa sta obojestransko v relaciji samo v primeru, če gre za en in isti element.
					
					\note{Mogoče pretiravam s slovenskimi imeni\ldots --Davorin}
				\item
					Relacija $R$ je \df{nesomerna} (ali \df{asimetrična}), kadar velja
					\[\xall{x, y}[X]{\lnot(x \mathrel{R} y \land y \mathrel{R} x)},\]
					tj.~nobena dva elementa nista obojestransko v relaciji.
				\item
					Relacija $R$ je \df{prehodna} (ali \df{tranzitivna}), kadar velja
					\[\all{x, y, z}[X]{x \mathrel{R} y \land y \mathrel{R} z \implies x \mathrel{R} z},\]
					tj.~če je en element v relaciji z drugim in drugi s tretjim, je tudi prvi v relaciji s tretjim.
				\item
					Relacija $R$ je \df{neprehodna} (ali \df{intranzitivna}), kadar velja
					\[\xall{x, y, z}[X]{\lnot(x \mathrel{R} y \land y \mathrel{R} z \land x \mathrel{R} z)},\]
					tj.~če je en element v relaciji z drugim in drugi s tretjim, prvi ne more tudi biti v relaciji s tretjim.
				\item
					Relacija $R$ je \df{enolična}, kadar velja
					\[\all{x, y, z}[X]{x \mathrel{R} y \land x \mathrel{R} z} \implies y = z,\]
					tj.~vsak element je v relaciji s kvečjemu enim elementom.
				\item
					Relacija $R$ je \df{sovisna}, kadar velja
					\[\all{x, y}[X]{x \neq y \implies x \mathrel{R} y \lor y \mathrel{R} x},\]
					tj.~za vsaka dva različna elementa velja, da je eden od njiju v relaciji z drugim.
				\item
					Relacija $R$ je \df{strogo sovisna}, kadar velja
					\[\all{x, y}[X]{x \mathrel{R} y \lor y \mathrel{R} x},\]
					tj.~za vsaka dva elementa velja, da je eden od njiju v relaciji z drugim.
			\end{itemize}
		\end{definicija}
		
		\begin{zgled}
			Za nekaj običajnih relacij si oglejmo njihove lastnosti.
			\begin{itemize}
				\item
					Relacija $\leq$ na $\NN$, $\ZZ$, $\QQ$, $\RR$ je refleksivna, antisimetrična, tranzitivna in strogo sovisna.
				\item
					Relacija $<$ na $\NN$, $\ZZ$, $\QQ$, $\RR$ je irefleksivna, asimetrična, tranzitivna in sovisna.
				\item
					Relacija deljivosti $|$ na $\NN_{\geq 1}$ je refleksivna, antisimetrična in tranzitivna.
				\item
					Relacija $\subseteq$ na $\pst(X)$ je refleksivna, antisimetrična in tranzitivna.
				\item
					Relacija enakosti $=_X$ na katerikoli množici $X$ je refleksivna, simetrična, tranzitivna in enolična.
			\end{itemize}
		\end{zgled}
		
		Lastnosti operacij smo podali z izjavami, ampak lahko jih na ekvivalenten način podamo z operacijami ali lastnostmi grafa --- glej tabelo~\ref{TABELA: lastnosti relacije}.
		
		\begin{table}[!ht]
			\centering
			\newcommand{\opis}[1]{\begin{minipage}{0.45\textwidth}\begin{center}{#1}\end{center}\end{minipage}}
			\def\arraystretch{3}
			\begin{tabular}{|ccc|}
				\hline
				\textbf{Lastnost relacije} & \textbf{Izražava z operacijami} & \textbf{Lastnost grafa} \\
				\hline
				refleksivnost & $=_X \subseteq R$ & \opis{Vsako vozlišče ima zanko.} \\
				irefleksivnost & $=_X \cap R = \emptyset$ & \opis{Nobeno vozlišče nima zanke.} \\
				simetričnost & $R = R^{-1}$ & \opis{Vsaka puščica ima nasprotno puščico.} \\
				antisimetričnost & $R \cap R^{-1} \subseteq =_X$ & \opis{Edine puščice z nasprotnimi puščicami so zanke.} \\
				asimetričnost & $R \cap R^{-1} = \emptyset$ & \opis{Nobena puščica nima nasprotne puščice.} \\
				tranzitivnost & $R^2 \subseteq R$ & \opis{Za vsako pot pozitivne dolžine obstaja puščica, ki gre od začetka do konca poti.} \\
				intranzitivnost & $R^2 \cap R = \emptyset$ & \opis{Za nobeno pot pozitivne dolžine ne obstaja puščica, ki gre od začetka do konca poti.} \\
				enoličnost & $R \circ R^{-1} \subseteq =_X$ & \opis{Iz vsakega vozlišča gre kvečjemu ena puščica.} \\
				sovisnost & $=_X \cup R \cup R^{-1} = X$ & \opis{Vsaki dve različni vozlišči sta povezani s puščico.} \\
				stroga sovisnost & $R \cup R^{-1} = X$ & \opis{Vsaki dve vozlišči sta povezani s puščico.} \\
				\hline
			\end{tabular}
			\caption{lastnosti relacije $R \subseteq X \times X$ in njihove karakterizacije}\label{TABELA: lastnosti relacije}
		\end{table}
		
		\begin{vaja}
			Dokaži, da so vse karakterizacije v vsaki vrstici tabele~\ref{TABELA: lastnosti relacije} res ekvivalentne!
		\end{vaja}
	
	
	\section{Funkcije kot funkcijske relacije}\label{RAZDELEK: Funkcije kot funkcijske relacije}
	\section{Relacije urejenosti}
		\note{Vključno z urejenostnimi strukturami. Vključno z morfizmi?}
	\section{Ekvivalenčne relacije in kvocientne množice}
		\note{Sem dodajmo kanonični razcep funkcije (na surjekcijo/kvocient, bijekcijo, injekcijo/vložitev).}